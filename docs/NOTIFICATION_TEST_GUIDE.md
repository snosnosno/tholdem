# 알림 시스템 종합 테스트 가이드

**버전**: 1.0.0
**작성일**: 2025-10-15
**목적**: 알림 시스템의 생성부터 표시, 인터랙션까지 전체 플로우 검증

---

## 📋 목차

1. [테스트 환경 준비](#1-테스트-환경-준비)
2. [알림 생성 플로우 테스트](#2-알림-생성-플로우-테스트)
3. [알림 표시 플로우 테스트](#3-알림-표시-플로우-테스트)
4. [알림 인터랙션 테스트](#4-알림-인터랙션-테스트)
5. [8가지 알림 타입별 테스트](#5-8가지-알림-타입별-테스트)
6. [라우팅 및 액션 테스트](#6-라우팅-및-액션-테스트)
7. [예상 결과 체크리스트](#7-예상-결과-체크리스트)

---

## 1. 테스트 환경 준비

### 1.1 사전 준비사항

**필수 조건**:
- ✅ 로그인된 사용자 계정
- ✅ 개발 서버 실행 (`npm start`)
- ✅ Firebase Firestore 연결 확인
- ✅ 브라우저 개발자 도구 열기 (F12)

**테스트 페이지**:
```
http://localhost:3000/app/test-notifications
```

### 1.2 브라우저 개발자 도구 설정

**Console 탭**:
```javascript
// 알림 로그 필터링
localStorage.setItem('debug', 'notification:*');
```

**Network 탭**:
- Firestore 요청 모니터링 활성화
- WebSocket 연결 확인

**Application 탭**:
- Firestore 데이터: `notifications` 컬렉션 확인

---

## 2. 알림 생성 플로우 테스트

### 2.1 Firestore 알림 생성 확인

**테스트 순서**:

#### Step 1: 테스트 페이지 접속
```
1. http://localhost:3000/app/test-notifications 접속
2. 페이지가 정상적으로 로드되는지 확인
3. "8가지 알림 타입을 테스트할 수 있습니다" 메시지 확인
```

**예상 결과**:
- ✅ 페이지 로드 성공
- ✅ 현재 사용자 이메일 표시
- ✅ 8개 알림 카테고리 카드 표시
  - 📢 시스템 알림 (4개)
  - 💼 근무 알림 (3개)
  - 📅 일정 알림 (1개)

#### Step 2: 개별 알림 생성 테스트

**테스트 절차**:
```
1. 시스템 알림 > "job_posting_announcement" 테스트 버튼 클릭
2. Console에서 로그 확인
3. 성공 메시지 확인: "✅ [공고 공지] ... - 알림 생성 완료!"
```

**Console 예상 로그**:
```javascript
[Logger] INFO: 알림 목록 업데이트 {
  count: 1,
  unreadCount: 1
}
```

**Firestore 확인**:
```
Application > Firestore > notifications 컬렉션
→ 새 문서 생성 확인
→ 필드 검증:
  - userId: 현재 사용자 UID
  - type: "job_posting_announcement"
  - category: "system"
  - priority: "high"
  - isRead: false
  - createdAt: Timestamp
```

#### Step 3: 전체 알림 생성 테스트

**테스트 절차**:
```
1. "🚀 전체 알림 테스트 (8개)" 버튼 클릭
2. 진행 메시지 확인: "🚀 8개의 알림을 생성하는 중..."
3. 완료 메시지 확인: "🎉 성공! 8개의 알림이 생성되었습니다!"
```

**예상 결과**:
- ✅ 8개 알림 모두 생성 성공
- ✅ Firestore에 8개 문서 생성 확인
- ✅ Console에 8번의 "알림 목록 업데이트" 로그

---

## 3. 알림 표시 플로우 테스트

### 3.1 실시간 구독 확인

**테스트 목적**: Firestore onSnapshot이 정상 작동하는지 확인

**테스트 절차**:
```
1. 알림 테스트 페이지에서 알림 1개 생성
2. 즉시 헤더의 알림 아이콘 확인
3. 빨간 배지에 숫자 "1" 표시 확인
```

**예상 결과**:
- ✅ 알림 생성 후 1초 이내에 배지 업데이트
- ✅ 페이지 새로고침 없이 실시간 반영
- ✅ useNotifications Hook의 onSnapshot 작동 확인

**Console 로그 확인**:
```javascript
[Logger] INFO: 알림 목록 업데이트 {
  count: 1,
  unreadCount: 1
}
```

### 3.2 알림 드롭다운 표시 확인

**테스트 절차**:
```
1. 헤더 우측 상단의 🔔 알림 아이콘 클릭
2. 드롭다운 메뉴 열림 확인
3. 최근 5개 알림 표시 확인
```

**예상 결과**:
- ✅ 드롭다운 메뉴 열림 (애니메이션 포함)
- ✅ 알림 리스트 표시
- ✅ 각 알림 항목에 다음 정보 포함:
  - 아이콘 (타입별 이모지)
  - 제목 (title)
  - 본문 (body)
  - 시간 (createdAt)
  - 읽음/안읽음 표시 (파란 점)

**UI 구조 확인**:
```
┌─────────────────────────────────┐
│ 알림          [모두 읽음] [⚙️]   │
├─────────────────────────────────┤
│ 📢 [공고 공지] 강남 홀덤펍...   │
│    5월 15일 강남점에서...        │
│    • 1분 전                      │
├─────────────────────────────────┤
│ 🎯 [신규 공고] 새로운...         │
│    홍대점에서 딜러 2명...        │
│    • 2분 전                      │
├─────────────────────────────────┤
│          [모두 보기]             │
└─────────────────────────────────┘
```

### 3.3 알림 센터 페이지 표시 확인

**테스트 절차**:
```
1. 드롭다운에서 "모두 보기" 클릭
2. /app/notifications 페이지로 이동 확인
3. 전체 알림 목록 표시 확인
```

**예상 결과**:
- ✅ 페이지 이동 성공
- ✅ 모든 알림 표시 (최대 50개)
- ✅ 필터 버튼 표시 (읽음/안읽음, 카테고리, 우선순위)
- ✅ 액션 버튼 표시 (모두 읽음, 읽은 알림 삭제)

---

## 4. 알림 인터랙션 테스트

### 4.1 읽음 처리 테스트

#### 개별 읽음 처리

**테스트 절차**:
```
1. 드롭다운 또는 알림 센터에서 알림 1개 클릭
2. 알림이 읽음 상태로 변경되는지 확인
3. Firestore에서 isRead: true 확인
```

**예상 결과**:
- ✅ 클릭 시 즉시 읽음 처리
- ✅ 파란 점(unread indicator) 사라짐
- ✅ 배경색 변경 (안읽음: 흰색 → 읽음: 회색)
- ✅ Firestore 업데이트 확인:
  - isRead: false → true
  - readAt: Timestamp 추가

**Console 로그**:
```javascript
[Logger] INFO: 알림 읽음 처리 {
  notificationId: "abc123..."
}
```

#### 모두 읽음 처리

**테스트 절차**:
```
1. 드롭다운 헤더의 "모두 읽음" 버튼 클릭
2. Toast 메시지 확인: "X개의 알림을 읽음 처리했습니다"
3. 모든 알림이 읽음 상태로 변경 확인
```

**예상 결과**:
- ✅ 모든 안읽음 알림 → 읽음 처리
- ✅ 배지 카운트 0으로 변경
- ✅ Firestore batch update 확인

**Console 로그**:
```javascript
[Logger] INFO: 모든 알림 읽음 처리 {
  count: 8
}
```

### 4.2 알림 삭제 테스트

#### 개별 삭제

**테스트 절차**:
```
1. 알림 센터에서 알림 1개의 삭제 버튼 (🗑️) 클릭
2. 확인 다이얼로그 확인 (있다면)
3. 알림이 목록에서 사라지는지 확인
```

**예상 결과**:
- ✅ 즉시 목록에서 제거
- ✅ Toast: "알림이 삭제되었습니다"
- ✅ Firestore에서 문서 삭제 확인

#### 읽은 알림 모두 삭제

**테스트 절차**:
```
1. 알림 센터의 "읽은 알림 삭제" 버튼 클릭
2. Toast 메시지 확인: "X개의 알림이 삭제되었습니다"
3. 읽은 알림만 삭제되고 안읽은 알림은 남아있는지 확인
```

**예상 결과**:
- ✅ 읽은 알림만 삭제
- ✅ 안읽은 알림은 유지
- ✅ Firestore batch delete 확인

### 4.3 외부 클릭 및 ESC 키 테스트

**테스트 절차**:
```
1. 드롭다운 열기
2. 드롭다운 외부 영역 클릭
3. 드롭다운이 닫히는지 확인

4. 다시 드롭다운 열기
5. ESC 키 누르기
6. 드롭다운이 닫히는지 확인
```

**예상 결과**:
- ✅ 외부 클릭 시 닫힘
- ✅ ESC 키 시 닫힘
- ✅ 부드러운 애니메이션

---

## 5. 8가지 알림 타입별 테스트

### 5.1 System 카테고리 (4개)

#### 1. job_posting_announcement

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: 📢
4. 색상: blue
5. 우선순위 배지: "높음" (orange)
6. 클릭 → /app/jobs 이동 확인
```

**예상 필드**:
```json
{
  "type": "job_posting_announcement",
  "category": "system",
  "priority": "high",
  "title": "[공고 공지] 강남 홀덤펍 토너먼트",
  "body": "5월 15일 강남점에서 딜러 3명을 모집합니다",
  "action": {
    "type": "navigate",
    "target": "/app/jobs"
  },
  "relatedId": "test-job-posting-123"
}
```

#### 2. new_job_posting

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: 🎯
4. 색상: blue
5. 우선순위 배지: "보통" (blue)
6. 클릭 → /app/jobs/test-job-posting-456 이동 확인
```

#### 3. system_announcement

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: 🔔
4. 색상: blue
5. 우선순위 배지: "보통" (blue)
6. 클릭 → /app/announcements 이동 확인
```

#### 4. app_update

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: 🔄
4. 색상: blue
5. 우선순위 배지: "낮음" (gray)
6. 클릭 → /app/announcements 이동 확인
```

### 5.2 Work 카테고리 (3개)

#### 5. job_application

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: 📝
4. 색상: green
5. 우선순위 배지: "보통" (blue)
6. 클릭 → /app/my-schedule 이동 확인
```

#### 6. staff_approval

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: ✅
4. 색상: green
5. 우선순위 배지: "높음" (orange)
6. 클릭 → /app/my-schedule 이동 확인
```

#### 7. staff_rejection

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: ❌
4. 색상: red
5. 우선순위 배지: "보통" (blue)
6. 클릭 → /app/my-schedule 이동 확인
```

### 5.3 Schedule 카테고리 (1개)

#### 8. schedule_change

**테스트**:
```
1. 테스트 버튼 클릭
2. 알림 생성 확인
3. 아이콘: 📅
4. 색상: orange
5. 우선순위 배지: "높음" (orange)
6. 클릭 → /app/my-schedule 이동 확인
```

---

## 6. 라우팅 및 액션 테스트

### 6.1 라우팅 매트릭스

| 알림 타입 | 라우팅 경로 | 파라미터 |
|-----------|-------------|----------|
| `job_posting_announcement` | `/app/jobs` | - |
| `new_job_posting` | `/app/jobs/{relatedId}` | relatedId 있을 경우 상세 페이지 |
| `system_announcement` | `/app/announcements` | - |
| `app_update` | `/app/announcements` | - |
| `job_application` | `/app/admin/job-postings` | - |
| `staff_approval` | `/app/my-schedule` | - |
| `staff_rejection` | `/app/my-schedule` | - |
| `schedule_change` | `/app/my-schedule` | - |

### 6.2 라우팅 테스트 절차

**각 알림 타입별**:
```
1. 알림 생성
2. 드롭다운 또는 알림 센터에서 알림 클릭
3. URL 변경 확인
4. 올바른 페이지 로드 확인
5. 뒤로가기 정상 작동 확인
```

**예상 결과**:
- ✅ 클릭 시 즉시 페이지 이동
- ✅ 알림이 읽음 처리됨
- ✅ 드롭다운 자동 닫힘
- ✅ 라우팅 히스토리에 기록됨

---

## 7. 예상 결과 체크리스트

### 7.1 알림 생성 (Firestore)

- [ ] 개별 알림 생성 성공
- [ ] 전체 8개 알림 생성 성공
- [ ] Firestore 문서 구조 정확
- [ ] userId 필드 정확
- [ ] createdAt Timestamp 생성
- [ ] 성공 Toast 메시지 표시

### 7.2 실시간 구독 (onSnapshot)

- [ ] 알림 생성 시 즉시 반영 (1초 이내)
- [ ] 페이지 새로고침 없이 업데이트
- [ ] 배지 카운트 실시간 업데이트
- [ ] Console 로그 정상 출력

### 7.3 알림 표시 (UI)

- [ ] 드롭다운 정상 열림/닫힘
- [ ] 최근 5개 알림 표시
- [ ] 알림 센터 전체 목록 표시
- [ ] 아이콘/색상 올바르게 표시
- [ ] 시간 포맷 정확 ("방금 전", "1분 전" 등)
- [ ] 읽음/안읽음 시각적 구분

### 7.4 인터랙션

- [ ] 개별 읽음 처리 작동
- [ ] 모두 읽음 처리 작동
- [ ] 개별 삭제 작동
- [ ] 읽은 알림 모두 삭제 작동
- [ ] 외부 클릭 시 드롭다운 닫힘
- [ ] ESC 키 시 드롭다운 닫힘

### 7.5 라우팅

- [ ] 8개 알림 타입 모두 라우팅 정확
- [ ] 클릭 시 올바른 페이지 이동
- [ ] relatedId 파라미터 전달 정확
- [ ] 뒤로가기 정상 작동

### 7.6 성능

- [ ] 알림 생성 응답 시간 < 500ms
- [ ] 실시간 업데이트 < 1초
- [ ] 드롭다운 열림 애니메이션 부드러움
- [ ] 페이지 전환 부드러움

### 7.7 오류 처리

- [ ] 네트워크 오류 시 Toast 에러 메시지
- [ ] Firestore 권한 오류 처리
- [ ] 로그인 안된 상태 처리
- [ ] 존재하지 않는 알림 처리

---

## 8. 디버깅 팁

### 8.1 알림이 표시되지 않을 때

**확인 사항**:
```
1. Firestore 규칙 확인
2. userId 필드가 현재 사용자 UID와 일치하는지 확인
3. Console에서 onSnapshot 에러 로그 확인
4. Network 탭에서 Firestore 요청 확인
```

### 8.2 실시간 업데이트가 안될 때

**확인 사항**:
```
1. WebSocket 연결 상태 확인 (Network 탭)
2. useNotifications Hook이 마운트되었는지 확인
3. useEffect cleanup 함수 정상 작동 확인
4. 브라우저 콘솔에서 에러 확인
```

### 8.3 라우팅이 안될 때

**확인 사항**:
```
1. notificationConfig.ts의 route 함수 확인
2. App.tsx의 라우트 설정 확인
3. 페이지 컴포넌트 존재 확인
4. 권한 검증 로직 확인
```

---

## 9. 테스트 완료 후

### 9.1 정리 작업

```
1. 테스트용 알림 모두 삭제
2. Firestore에서 테스트 데이터 정리
3. Console 로그 확인 및 저장
4. 발견된 버그 이슈 등록
```

### 9.2 테스트 보고서 작성

**포함 내용**:
- 테스트 일시
- 테스트 환경 (브라우저, OS)
- 성공/실패 항목
- 발견된 버그
- 개선 제안

---

**문서 버전**: 1.0.0
**최종 업데이트**: 2025-10-15
**담당자**: Development Team

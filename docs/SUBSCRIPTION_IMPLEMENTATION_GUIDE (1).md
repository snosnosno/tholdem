# 🚀 T-HOLDEM 구독 모델 구현 가이드

**최종 업데이트**: 2025년 10월 23일  
**버전**: v1.0.0 - 최신 수익 분석 반영  
**목표**: 프리/일반/프로/팀 구독 모델 + 무료체험 + 추천 시스템 완전 구현

> [!IMPORTANT]
> **최신 업데이트**: 거래 수수료 제거, 린 운영 비용(월 ₩7M) 반영  
> **핵심 변경**: BEP 7개월 달성 가능, 필요 자본 ₩50M으로 축소  
> **수익 구조**: 구독료 41.3% + 컨설팅 44% + 애드온 14.7%

---

## 📋 목차

1. [전체 시스템 아키텍처](#1-전체-시스템-아키텍처)
2. [데이터베이스 설계](#2-데이터베이스-설계)
3. [결제 시스템 통합](#3-결제-시스템-통합)
4. [무료 체험 시스템](#4-무료-체험-시스템)
5. [추천인 시스템](#5-추천인-시스템)
6. [크레딧 시스템](#6-크레딧-시스템)
7. [구독 제한 관리](#7-구독-제한-관리)
8. [청구 및 정산](#8-청구-및-정산)
9. [관리자 기능](#9-관리자-기능)
10. [보안 및 규정 준수](#10-보안-및-규정-준수)
11. [개선안 및 추천사항](#11-개선안-및-추천사항)

---

## 1. 전체 시스템 아키텍처

### 1.1 핵심 구성 요소

```
사용자 인터페이스 (React)
    ↓
인증 레이어 (Firebase Auth)
    ↓
비즈니스 로직 (Firebase Functions)
    ↓
데이터베이스 (Firestore)
    ↓
결제 게이트웨이 (Toss Payments / 다른 PG사)
```

### 1.2 주요 모듈

**필요한 주요 모듈들:**

1. **구독 관리 모듈**
   - 플랜 선택 및 변경
   - 업그레이드/다운그레이드 처리
   - 구독 갱신 자동화

2. **결제 처리 모듈**
   - PG사 연동 (Toss Payments 권장)
   - 결제 성공/실패 처리
   - 환불 및 취소 처리
   - **주의**: 거래 수수료 모델은 제외됨 (구독료 + 애드온 + 컨설팅 중심)

3. **무료 체험 모듈**
   - 체험 기간 관리 (14일/1개월)
   - 체험 종료 알림
   - 자동 유료 전환

4. **추천인 모듈**
   - 추천 코드 생성
   - 추천 관계 추적
   - 크레딧 지급 자동화

5. **사용량 추적 모듈**
   - 공고 등록 횟수
   - 지원 횟수
   - 기능 사용 제한

6. **알림 모듈**
   - 이메일 알림 (결제, 체험 종료)
   - 인앱 알림
   - SMS 알림 (선택)

---

## 2. 데이터베이스 설계

### 2.1 Firestore 컬렉션 구조

#### A. subscriptions 컬렉션 (신규)

```javascript
{
  // 문서 ID = userId
  userId: "uid_12345",
  
  // 현재 구독 정보
  currentPlan: "pro",  // "free" | "standard" | "pro" | "team"
  status: "active",    // "active" | "trialing" | "past_due" | "canceled" | "expired"
  
  // 구독 기간
  startDate: Timestamp,
  endDate: Timestamp,      // 다음 갱신일
  
  // 결제 정보
  billingCycle: "monthly", // "monthly" | "yearly"
  amount: 13900,           // 월/연 구독료
  currency: "KRW",
  
  // 체험 정보
  isTrial: true,
  trialStartDate: Timestamp,
  trialEndDate: Timestamp,
  trialPlan: "pro",        // 체험 중인 플랜
  
  // 결제 수단 정보
  paymentMethod: {
    type: "card",          // "card" | "bank_transfer" | "virtual_account"
    last4: "1234",         // 카드 마지막 4자리
    billingKey: "tok_xxx", // PG사 빌링키 (정기결제용)
  },
  
  // 사용량 카운터 (매월 1일 초기화)
  usage: {
    jobPostings: 5,        // 이번 달 공고 등록 수
    applications: 15,      // 이번 달 지원 수
    resetDate: Timestamp   // 다음 초기화 날짜
  },
  
  // 크레딧
  credits: 7000,           // 사용 가능한 크레딧 (원 단위)
  
  // 플랜 제한 (현재 플랜 기준)
  limits: {
    maxJobPostings: 10,
    maxApplications: 30,
    features: ["schedules", "applicant_management"]
  },
  
  // 추천인 정보
  referralCode: "USER123", // 내 추천 코드
  referredBy: "USER456",   // 추천인 코드 (있으면)
  
  // 자동 갱신 설정
  autoRenew: true,
  
  // 취소 정보
  canceledAt: null,
  cancelReason: null,
  
  // 타임스탬프
  createdAt: Timestamp,
  updatedAt: Timestamp,
  
  // 변경 이력 추적
  planHistory: [
    {
      plan: "standard",
      startDate: Timestamp,
      endDate: Timestamp,
      reason: "upgrade"
    }
  ]
}
```

#### B. payments 컬렉션 (신규)

```javascript
{
  // 문서 ID = 자동 생성
  paymentId: "pay_12345",
  
  userId: "uid_12345",
  subscriptionId: "sub_12345",
  
  // 결제 정보
  amount: 13900,
  currency: "KRW",
  
  // 결제 타입
  type: "subscription",    // "subscription" | "credit_purchase" | "addon"
  description: "프로 플랜 월 구독료",
  
  // 결제 상태
  status: "paid",          // "pending" | "paid" | "failed" | "refunded" | "canceled"
  
  // PG사 정보
  pgProvider: "tosspayments",
  pgTransactionId: "toss_tx_12345",
  
  // 결제 수단
  method: "card",
  cardInfo: {
    last4: "1234",
    brand: "신한카드"
  },
  
  // 타임스탬프
  paidAt: Timestamp,
  createdAt: Timestamp,
  
  // 환불 정보
  refundedAt: null,
  refundAmount: null,
  refundReason: null
}
```

#### C. referrals 컬렉션 (신규)

```javascript
{
  // 문서 ID = 추천 코드
  referralCode: "USER123",
  
  // 추천인 정보
  referrerId: "uid_12345",
  referrerName: "김철수",
  
  // 통계
  totalReferrals: 5,       // 총 추천 수
  convertedReferrals: 2,   // 유료 전환 수
  totalCreditsEarned: 14000, // 총 획득 크레딧
  
  // 추천받은 사람들 목록
  referredUsers: [
    {
      userId: "uid_67890",
      signupDate: Timestamp,
      converted: true,
      conversionDate: Timestamp,
      creditsGiven: 7000     // 이 추천으로 받은 크레딧
    }
  ],
  
  createdAt: Timestamp,
  updatedAt: Timestamp
}
```

#### D. credits 컬렉션 (신규)

```javascript
{
  // 문서 ID = 자동 생성
  transactionId: "cred_12345",
  
  userId: "uid_12345",
  
  // 트랜잭션 정보
  type: "earned",          // "earned" | "used" | "expired" | "refunded"
  amount: 5000,            // 양수면 적립, 음수면 사용
  
  // 이유
  reason: "referral_conversion", // 크레딧 발생 이유
  description: "추천인 유료 전환 보너스",
  
  // 잔액
  balanceBefore: 2000,
  balanceAfter: 7000,
  
  // 관련 정보
  relatedUserId: "uid_67890",    // 추천받은 사람 ID (있으면)
  relatedPaymentId: "pay_12345", // 관련 결제 ID (있으면)
  
  // 만료 정보
  expiresAt: Timestamp,    // 크레딧 만료일 (1년)
  
  createdAt: Timestamp
}
```

#### E. 기존 users 컬렉션에 추가할 필드

```javascript
{
  // ... 기존 필드들 ...
  
  // 구독 관련 (간단한 참조용)
  subscriptionPlan: "pro",
  subscriptionStatus: "active",
  
  // 추천 코드
  referralCode: "USER123",
  
  // 온보딩 상태
  onboardingCompleted: true,
  trialUsed: false,        // 무료 체험 사용 여부
}
```

### 2.2 데이터베이스 인덱스

**Firestore 인덱스 필요 항목:**

1. subscriptions 컬렉션:
   - `status` + `endDate` (곧 만료되는 구독 찾기)
   - `userId` + `status` (사용자별 구독 조회)

2. payments 컬렉션:
   - `userId` + `createdAt` (사용자별 결제 이력)
   - `status` + `createdAt` (실패한 결제 조회)

3. credits 컬렉션:
   - `userId` + `createdAt` (사용자별 크레딧 이력)
   - `expiresAt` + `userId` (만료 예정 크레딧)

---

## 3. 결제 시스템 통합

### 3.1 PG사 선택 및 연동

**추천 PG사: Toss Payments**

이유:
- 한국 시장 최적화
- 쉬운 연동 (SDK 및 문서 우수)
- 정기결제(빌링키) 지원
- 합리적인 수수료 (약 3.3%)
- 다양한 결제 수단 지원

**대안:**
- 카카오페이 (간편결제 선호 시)
- 네이버페이
- NHN KCP (전통적 PG)

### 3.2 결제 플로우

#### A. 최초 구독 신청

```
1. 사용자가 플랜 선택
   ↓
2. 프론트엔드에서 Toss Payments Widget 호출
   ↓
3. 사용자가 결제 정보 입력
   ↓
4. Toss에서 임시 토큰 발급 (customerKey + billingKey)
   ↓
5. Firebase Function 호출하여 빌링키 저장
   ↓
6. Firestore에 subscription 문서 생성
   ↓
7. 최초 결제 실행
   ↓
8. 결제 성공 시 구독 활성화
   ↓
9. 사용자에게 확인 이메일 발송
```

#### B. 정기 결제 (매월 자동 갱신)

```
1. Firebase Scheduled Function (매일 1회 실행)
   ↓
2. 만료 예정 구독 조회 (endDate가 오늘인 것들)
   ↓
3. autoRenew가 true인 구독만 필터링
   ↓
4. 저장된 빌링키로 자동 결제 요청
   ↓
5. 결제 성공 시:
   - subscription.endDate 1개월 연장
   - payments 컬렉션에 기록
   - 사용자에게 영수증 이메일
   ↓
6. 결제 실패 시:
   - subscription.status = "past_due"
   - 사용자에게 결제 실패 알림
   - 3일 후 재시도
   - 7일 후에도 실패하면 구독 일시 정지
```

### 3.3 환불 처리

**환불 정책:**
- 구독 시작 7일 이내: 100% 환불
- 7일 이후: 사용한 기간 제외하고 일할 계산 환불
- 연간 구독: 남은 개월 수에 비례하여 환불

**환불 플로우:**

```
1. 사용자가 환불 요청
   ↓
2. 관리자 승인 또는 자동 승인 (정책에 따라)
   ↓
3. Firebase Function에서 환불 금액 계산
   ↓
4. Toss Payments API로 환불 요청
   ↓
5. 환불 성공 시:
   - subscription.status = "canceled"
   - payments에 환불 기록
   - 사용자에게 환불 확인 이메일
```

### 3.4 필요한 Firebase Functions

1. **createSubscription**
   - 새 구독 생성
   - 빌링키 저장
   - 최초 결제 실행

2. **processRecurringPayments** (Scheduled)
   - 매일 실행
   - 갱신 대상 구독 조회
   - 자동 결제 실행

3. **cancelSubscription**
   - 구독 취소
   - 환불 처리 (필요 시)

4. **upgradeSubscription**
   - 플랜 업그레이드
   - 차액 결제

5. **handlePaymentWebhook**
   - PG사 웹훅 처리
   - 결제 상태 업데이트

---

## 4. 무료 체험 시스템

### 4.1 체험 정책

**런칭 프로모션 (첫 2주):**
- 대상: 모든 신규 가입자
- 혜택: 프로 플랜 1개월 무료
- 조건: 신용카드 등록 필수
- 종료 후: 자동으로 유료 전환 (알림 후)

**일반 체험 (런칭 2주 후):**
- 대상: 신규 가입자
- 혜택: 프로 플랜 14일 무료
- 조건: 신용카드 등록 필수
- 종료 후: 자동으로 유료 전환 또는 무료 플랜 다운그레이드

### 4.2 체험 시작 플로우

```
1. 회원가입 완료
   ↓
2. 온보딩 화면에서 "무료 체험 시작" 버튼
   ↓
3. 신용카드 정보 입력 (결제는 안 됨, 빌링키만 발급)
   ↓
4. subscription 문서 생성:
   - status = "trialing"
   - isTrial = true
   - trialPlan = "pro"
   - trialEndDate = 오늘 + 14일 (또는 1개월)
   ↓
5. 프로 플랜 기능 모두 사용 가능
```

### 4.3 체험 종료 처리

**체험 종료 3일 전:**
- 이메일 알림: "무료 체험이 곧 종료됩니다"
- 인앱 알림
- 계속 사용하려면 아무 것도 안 해도 됨
- 취소하려면 구독 취소 버튼 클릭

**체험 종료 1일 전:**
- 마지막 알림 발송
- "내일 자동으로 유료 전환됩니다"

**체험 종료 당일:**
```
Firebase Scheduled Function 실행
   ↓
체험 종료된 구독 조회 (trialEndDate가 오늘인 것)
   ↓
자동 결제 시도:
   성공 → status = "active", isTrial = false
   실패 → status = "past_due", 재시도 알림
   ↓
결제 성공 시 구독 갱신 이메일 발송
```

### 4.4 중복 체험 방지

- users 컬렉션에 `trialUsed: true` 플래그
- 회원가입 시 이메일/전화번호로 중복 체크
- 동일 결제 수단으로 중복 체험 방지 (빌링키 해시 비교)

---

## 5. 추천인 시스템

### 5.1 추천 코드 생성

**코드 생성 규칙:**
- 형식: 대문자 + 숫자, 6-8자
- 예시: "USER123", "ALICE99"
- 중복 불가
- 사용자 이름 기반 자동 생성 또는 수동 입력

**생성 시점:**
- 회원가입 완료 후 자동 생성
- 사용자가 마이페이지에서 수정 가능 (1회 제한)

### 5.2 추천 플로우

```
1. 추천인(A)이 자신의 추천 코드 공유
   ↓
2. 신규 사용자(B)가 회원가입 시 추천 코드 입력
   ↓
3. users(B).referredBy = A의 추천 코드
   ↓
4. referrals 컬렉션 업데이트:
   - A의 totalReferrals++
   - referredUsers 배열에 B 추가
   ↓
5. 즉시 크레딧 지급:
   - A에게 2,000원 크레딧
   - B에게 2,000원 크레딧
   ↓
6. credits 컬렉션에 트랜잭션 기록
```

### 5.3 전환 보너스

```
B가 유료 구독으로 전환하면:
   ↓
Firebase Function (onPaymentSuccess) 트리거
   ↓
B의 referredBy 조회
   ↓
A가 있으면:
   - A에게 5,000원 크레딧 추가 지급
   - referrals(A).convertedReferrals++
   - referrals(A).totalCreditsEarned += 5000
   ↓
A에게 "추천인이 유료 전환했습니다!" 알림 발송
```

### 5.4 추천 통계 대시보드

**사용자 마이페이지에 표시:**
- 내 추천 코드
- 총 추천 수
- 유료 전환 수
- 총 획득 크레딧
- 추천 링크 (공유하기 버튼)

---

## 6. 크레딧 시스템

### 6.1 크레딧 획득 방법

1. **추천인 가입 크레딧**: 2,000원
2. **추천인 전환 보너스**: 5,000원
3. **프로모션 크레딧**: 이벤트별로 지급
4. **보상 크레딧**: 버그 제보, 리뷰 작성 등

### 6.2 크레딧 사용 방법

**사용 우선순위:**
1. 먼저 만료 예정인 크레딧부터 사용
2. 구독료 결제 시 자동 차감
3. 애드온 구매 시 사용 가능

**사용 플로우:**

```
구독 갱신 시:
   ↓
사용자의 credits 잔액 조회
   ↓
구독료 13,900원 - 크레딧 7,000원 = 실제 결제 6,900원
   ↓
PG사로 6,900원 결제 요청
   ↓
결제 성공 시:
   - credits에서 7,000원 차감 기록
   - payments에 결제 기록 (할인 금액 명시)
```

### 6.3 크레딧 만료 정책

- 발급일로부터 1년 후 자동 만료
- 만료 30일 전 알림
- 만료 7일 전 재알림

**만료 처리 Function:**

```
매일 실행되는 Scheduled Function:
   ↓
오늘 만료되는 크레딧 조회
   ↓
각 사용자의 credits 잔액에서 차감
   ↓
credits 컬렉션에 만료 기록
   ↓
사용자에게 만료 알림
```

### 6.4 크레딧 환불 불가 정책

- 크레딧은 현금으로 환불 불가
- 단, 서비스 오류로 크레딧 차감 시 복구
- 구독 취소 시에도 크레딧은 유지 (1년 내 재구독 시 사용 가능)

---

## 7. 구독 제한 관리

### 7.1 플랜별 제한 사항

```javascript
const PLAN_LIMITS = {
  free: {
    maxJobPostings: 3,
    maxApplications: 10,
    features: ["job_search", "applicant_basic"]
  },
  standard: {
    maxJobPostings: 10,
    maxApplications: 30,
    features: ["job_search", "applicant_all", "schedules"]
  },
  pro: {
    maxJobPostings: 30,
    maxApplications: 100,
    features: ["all", "tournament", "participants", "tables", "shifts", "prizes"]
  },
  team: {
    maxJobPostings: 100,
    maxApplications: -1, // unlimited
    features: ["all", "team_collaboration"]
  }
};
```

### 7.2 사용량 추적

**매번 공고 등록 시:**

```
1. 사용자가 "공고 등록" 버튼 클릭
   ↓
2. Firebase Function에서 현재 구독 조회
   ↓
3. usage.jobPostings vs limits.maxJobPostings 비교
   ↓
4. 제한 초과 시:
   - 에러 반환
   - "이번 달 공고 등록 한도 초과. 프로 플랜으로 업그레이드하세요" 메시지
   ↓
5. 제한 내면:
   - 공고 등록 허용
   - usage.jobPostings++ (트랜잭션으로 안전하게)
```

**매월 1일 초기화:**

```
Scheduled Function (매월 1일 00:00 실행):
   ↓
모든 subscriptions 문서 조회
   ↓
usage.jobPostings = 0
usage.applications = 0
usage.resetDate = 다음 달 1일
```

### 7.3 기능 접근 제어

**React 컴포넌트에서:**

```javascript
// useSubscription 훅 사용
const { subscription, hasFeature, canCreateJobPosting } = useSubscription();

// 기능 제한 체크
if (!hasFeature("tournament")) {
  return <UpgradePrompt feature="토너먼트 관리" requiredPlan="pro" />;
}

// 사용량 제한 체크
if (!canCreateJobPosting()) {
  return <UsageLimitPrompt currentUsage={usage.jobPostings} limit={limits.maxJobPostings} />;
}
```

### 7.4 Soft Limit vs Hard Limit

**Soft Limit (권장):**
- 제한 초과 시 경고 표시하지만 일시적으로 허용
- 예: "이번 달 한도를 초과했습니다. 다음 달부터는 프로 플랜으로 업그레이드해주세요"
- 사용자 경험 개선

**Hard Limit (필수):**
- 제한 초과 시 기능 차단
- 예: 팀 플랜 전용 기능은 다른 플랜에서 아예 접근 불가

---

## 8. 청구 및 정산

### 8.1 청구서 발행

**매월 결제 후:**
- 자동으로 청구서 PDF 생성
- 이메일로 발송
- 마이페이지에서 다운로드 가능

**청구서 내용:**
- 청구일자
- 플랜명 및 금액
- 크레딧 사용액
- 실제 결제 금액
- 결제 수단
- 세금계산서 정보 (사업자일 경우)

### 8.2 세금계산서 발행 (선택)

**사업자 사용자를 위한 기능:**
- 사업자 정보 등록
- 세금계산서 자동 발행 (국세청 연동)
- 이메일로 발송

### 8.3 관리자 정산 대시보드

**관리자가 확인할 수 있는 정보:**
- 일별/월별 매출
- 플랜별 구독자 수
- 신규 구독/해지 추이
- 결제 실패율
- 환불 현황
- 크레딧 지급 현황
- 추천 통계

---

## 9. 관리자 기능

### 9.1 구독 관리 기능

**관리자 패널에서 할 수 있는 작업:**

1. **구독 조회 및 검색**
   - 사용자 이름/이메일로 검색
   - 플랜별 필터
   - 상태별 필터 (active, trialing, past_due, canceled)

2. **수동 구독 변경**
   - 플랜 강제 업그레이드/다운그레이드
   - 구독 기간 연장
   - 무료 체험 부여

3. **크레딧 수동 지급/차감**
   - 이벤트 크레딧 일괄 지급
   - 오류 보상 크레딧 지급
   - 부정 사용자 크레딧 회수

4. **결제 재시도**
   - 실패한 결제 수동 재시도
   - 다른 결제 수단으로 재시도 요청

5. **구독 일시 정지**
   - 부정 사용자 구독 정지
   - 정지 사유 기록

### 9.2 분석 및 리포트

**관리자 대시보드 핵심 KPI (최신 업데이트):**

**재무 지표:**
- MRR (Monthly Recurring Revenue): 목표 ₩10.2M
- ARR (Annual Recurring Revenue): 목표 ₩122M
- 구독 수익률: 41.3%
- 컨설팅 수익률: 44% (매우 중요!)
- 애드온 수익률: 14.7%

**고객 지표:**
- Churn Rate (해지율): 목표 <5%
- ARPU (Average Revenue Per User): 현재 ₩8,451, 목표 ₩12,000
- LTV (Lifetime Value): ₩165,882
- CAC (Customer Acquisition Cost): 
  - 일반 마케팅: ₩400,000
  - 추천 시스템: ₩7,000 (80% 절감!)
- LTV/CAC 비율: 0.91 → 목표 1.5+ (추천 시스템으로)

**성장 지표:**
- 무료 체험 전환율: 목표 50%
- 플랜별 분포:
  - 프리: 50%
  - 일반: 35%
  - 프로: 14.5%
  - 팀: 0.5%
- 월 성장률: 목표 15-20%
- BEP 달성 진행률: 목표 7개월

**컨설팅 사업 KPI (신규):**
- 월 컨설팅 건수: 목표 3-4건
- 평균 단가: ₩1.5M/건
- 컨설팅 전환율: 구독자의 5%
- 재계약률: 목표 70%

### 9.3 쿠폰 시스템 (추가 기능)

**프로모션용 쿠폰 발행:**

```javascript
{
  couponCode: "LAUNCH2025",
  type: "discount",       // "discount" | "free_trial" | "credit"
  value: 5000,            // 할인 금액 또는 크레딧 금액
  discountType: "amount", // "amount" | "percent"
  applicablePlans: ["standard", "pro"],
  maxUses: 100,           // 최대 사용 횟수
  usedCount: 23,
  expiresAt: Timestamp,
  isActive: true
}
```

---

## 10. 보안 및 규정 준수

### 10.1 결제 정보 보안

**절대 하지 말아야 할 것:**
- Firestore에 신용카드 전체 번호 저장 ❌
- Firestore에 CVV 저장 ❌
- 로그에 민감한 결제 정보 기록 ❌

**해야 할 것:**
- PG사의 빌링키만 저장 ✅
- 카드 마지막 4자리만 표시용으로 저장 ✅
- HTTPS 강제 ✅
- Firebase Security Rules 엄격하게 설정 ✅

### 10.2 Firestore Security Rules

```javascript
// subscriptions 컬렉션 보안 규칙
match /subscriptions/{userId} {
  allow read: if request.auth != null && request.auth.uid == userId;
  allow write: if false; // Functions에서만 쓰기 가능
}

// payments 컬렉션 보안 규칙
match /payments/{paymentId} {
  allow read: if request.auth != null && 
               resource.data.userId == request.auth.uid;
  allow write: if false; // Functions에서만 쓰기 가능
}

// referrals 컬렉션 보안 규칙
match /referrals/{referralCode} {
  allow read: if request.auth != null;
  allow write: if false; // Functions에서만 쓰기 가능
}

// credits 컬렉션 보안 규칙
match /credits/{transactionId} {
  allow read: if request.auth != null && 
               resource.data.userId == request.auth.uid;
  allow write: if false; // Functions에서만 쓰기 가능
}
```

### 10.3 데이터 암호화

- Firebase는 기본적으로 at-rest 암호화 제공
- 추가 민감 정보는 클라이언트에서 암호화 후 저장
- 백업 데이터도 암호화

### 10.4 규정 준수

**한국 전자금융거래법:**
- 결제 내역 5년 보관 의무
- 사용자에게 결제 알림 의무
- 환불 정책 명시 의무

**개인정보보호법:**
- 결제 정보는 동의 후 수집
- 목적 외 사용 금지
- 안전한 파기

**PCI DSS (카드 정보 보안 표준):**
- PG사에 위임하므로 직접 준수 불필요
- 단, 빌링키 관리는 안전하게

---

## 11. 개선안 및 추천사항

### 11.0 최신 수익 분석 반영 전략 ✨

#### 핵심 비즈니스 전략 변경사항

**수익 구조 (12개월 기준):**
```
월 수익: ₩10,225,500
├── 구독료: ₩4,225,500 (41.3%)
├── 컨설팅: ₩4,500,000 (44.0%)
└── 애드온: ₩1,500,000 (14.7%)

연간 수익: ₩122,706,000
```

**운영 비용 (린 운영):**
```
월 비용: ₩7,000,000
├── 개발/운영: ₩1,000,000
├── 마케팅: ₩1,000,000
├── 인건비: ₩2,000,000
├── 인프라: ₩2,000,000
└── 기타: ₩1,000,000
```

**BEP 달성:**
- 필요 고객: 342명 (통합 수익 기준)
- 달성 시점: 7개월 (월 50명 확보 시)
- 초기 자본: ₩50M (7개월 버닝레이트)

**중요 포인트:**
1. ⚠️ **거래 수수료 모델 제거**: 더 이상 급여 지급 수수료 없음
2. ✅ **컨설팅 사업 강화**: 전체 수익의 44% 차지 (매우 중요!)
3. ✅ **린 운영**: 월 ₩7M으로 효율적 운영
4. ✅ **빠른 BEP**: 7개월 내 달성 가능

### 11.1 단계별 구현 로드맵 (업데이트)

#### Phase 1: MVP (0-6개월) - 빠른 성장

**필수 기능:**
1. 기본 구독 모델 (프리/일반/프로만) ✅
2. 수동 결제 (PG 연동 기본) ✅
3. 사용량 제한 (공고/지원 횟수) ✅
4. 무료 체험 시스템 (프로 1개월) ✅
5. 추천 시스템 (초기부터 필수!) ✅
6. 간단한 관리자 페이지 ✅

**건너뛸 수 있는 것:**
- 팀 플랜 (6개월 이후)
- 크레딧 시스템 (3개월 이후)
- 고급 분석 (3개월 이후)

**목표:**
- 300명 확보 (BEP 90%)
- 구독료 ₩2M/월
- 컨설팅 ₩2M/월 시작

**Phase 1 집중 사항:**
```
🎯 추천 시스템을 초기부터 필수로!
• CAC 80% 절감 효과 (₩400K → ₩7K)
• 바이럴 성장 기반 구축
• 가입 크레딧 ₩2,000
• 전환 보너스 ₩5,000
```

#### Phase 2: 성장 가속 (6-12개월) - BEP 달성

**핵심 기능:**
1. 컨설팅 서비스 본격화 💼
   - 패키지 상품화
   - 표준 가격 정립
   - 목표: ₩5M/월
2. 크레딧 시스템 완성
3. 정기 결제 완전 자동화
4. 이메일 마케팅 자동화
5. 애드온 판매 강화

**목표:**
- 500명 확보 (BEP 달성!)
- 구독료 ₩4.2M/월
- 컨설팅 ₩5M/월
- 애드온 ₩1.5M/월

**Phase 2 집중 사항:**
```
💼 컨설팅 사업이 핵심!
• 44% 수익 기여
• 운영 최적화 패키지: ₩500K/건
• 맞춤형 개발: ₩3M/건
• 월 평균 3-4건 목표
```

#### Phase 3: 확장 (12-24개월) - 시장 리더십

**확장 기능:**
1. 팀 플랜 본격 런칭
2. API 개방 및 파트너십
3. 쿠폰 시스템
4. 고급 분석 대시보드
5. A/B 테스팅
6. 해외 진출 준비

**목표:**
- 2,500명 확보
- 월 수익 ₩48M
- 순이익률 79%

1. 쿠폰 시스템
2. 고급 분석 대시보드
3. A/B 테스팅
4. 이탈 방지 캠페인 자동화
5. 다양한 결제 수단 추가

### 11.2 기술적 추천사항

#### A. PG사 연동은 SDK 사용

**Toss Payments 기준:**
- 프론트엔드: `@tosspayments/widget-sdk`
- 백엔드: REST API
- 웹훅: Express 미들웨어

**장점:**
- 빠른 개발
- PCI DSS 준수 자동
- UI/UX 최적화됨

#### B. Firebase Extensions 활용

**유용한 Extensions:**
1. **Run Payments with Stripe**
   - Stripe 사용 시 자동 구독 관리
   - 완전 자동화

2. **Trigger Email from Firestore**
   - 구독 관련 이메일 자동 발송
   - 템플릿 관리

3. **Schedule Functions**
   - 정기 결제 등 스케줄 작업
   - Cron 설정 불필요

#### C. 상태 관리

**React Context + Firebase Hooks:**
```javascript
// useSubscription.tsx
export const useSubscription = () => {
  const { user } = useAuth();
  const [subscription, setSubscription] = useState(null);
  
  useEffect(() => {
    if (!user) return;
    
    const unsubscribe = onSnapshot(
      doc(db, 'subscriptions', user.uid),
      (doc) => setSubscription(doc.data())
    );
    
    return unsubscribe;
  }, [user]);
  
  const hasFeature = (feature: string) => {
    return subscription?.limits?.features?.includes(feature);
  };
  
  const canCreateJobPosting = () => {
    return subscription?.usage?.jobPostings < subscription?.limits?.maxJobPostings;
  };
  
  return { subscription, hasFeature, canCreateJobPosting };
};
```

#### D. 에러 처리 및 로깅

**필수 로깅:**
1. 모든 결제 시도 (성공/실패)
2. 구독 상태 변경
3. 크레딧 트랜잭션
4. 추천 코드 사용
5. 사용량 제한 도달

**추천 도구:**
- Sentry: 에러 추적
- Firebase Analytics: 사용자 행동
- Mixpanel: 코호트 분석

### 11.3 비즈니스 로직 개선안

#### A. 플랜 업그레이드 인센티브

**중간 업그레이드 할인:**
- 무료 → 일반: 첫 달 50% 할인
- 일반 → 프로: 첫 달 30% 할인
- 프로 → 팀: 3개월 20% 할인

**일할 계산 업그레이드:**
- 플랜 변경 즉시 적용
- 남은 기간 일할 계산하여 차액만 결제
- 다운그레이드는 다음 갱신일부터 적용

#### B. 연간 구독 추가 혜택

**연간 구독 시:**
- 20% 할인
- 추가 크레딧 5,000원 지급
- 우선 고객 지원
- 베타 기능 먼저 체험

#### C. 사용량 기반 요금제 (선택)

**프로 플랜 변형:**
- 기본: 공고 30개 + 지원 100회
- 초과 사용: 공고당 500원, 지원당 100원
- 월 최대 50,000원

**장점:**
- 사용자가 부담 없이 시작
- 많이 쓰는 사용자는 더 많이 지불
- 이탈률 감소

#### D. 가족/팀 공유 플랜

**팀 플랜 개선:**
- 메인 계정 1개 + 서브 계정 3-5개
- 모든 구성원이 프로 기능 사용
- 통합 청구
- 통합 관리 대시보드

### 11.4 사용자 경험 개선

#### A. 온보딩 최적화

**신규 가입자용 체크리스트:**
```
✅ 프로필 완성 (10% 완료)
✅ 첫 공고 등록 (30% 완료)
✅ 첫 지원자 승인 (50% 완료)
✅ 출석 체크 사용 (70% 완료)
✅ 급여 지급 완료 (100% 완료)
```

**각 단계마다 가이드 제공:**
- 비디오 튜토리얼
- 툴팁
- 샘플 데이터

#### B. 업그레이드 유도 UI

**플랜 제한 도달 시:**
```
┌─────────────────────────────────────┐
│  🚀 공고 등록 한도에 도달했습니다!    │
│                                     │
│  이번 달: 10개 / 10개               │
│  다음 초기화: 8일 남음               │
│                                     │
│  프로 플랜으로 업그레이드하면:       │
│  ✅ 공고 30개까지                   │
│  ✅ 토너먼트 관리 기능               │
│  ✅ 우선 지원                       │
│                                     │
│  [프로 플랜 보기] [나중에]           │
└─────────────────────────────────────┘
```

#### C. 가격 페이지 최적화

**심리적 가격 전략:**
- ~~₩4,900~~ → ₩4,900 (할인 표시 제거)
- 월별 vs 연간 토글 (연간 선택 시 "2개월 무료" 강조)
- 가장 인기 있는 플랜 배지 (프로 플랜)
- 각 플랜에 "이런 분께 추천" 설명

**비교 테이블:**
```
┌──────────┬─────────┬─────────┬─────────┬──────────┐
│ 기능     │ 무료    │ 일반    │ 프로    │ 팀       │
├──────────┼─────────┼─────────┼─────────┼──────────┤
│ 공고     │ 3개     │ 10개    │ 30개    │ 100개    │
│ 지원     │ 10회    │ 30회    │ 100회   │ 무제한   │
│ 토너먼트 │ ❌      │ ❌      │ ✅      │ ✅       │
│ 팀 협업  │ ❌      │ ❌      │ ❌      │ ✅       │
│ 가격     │ 무료    │ ₩4,900  │ ₩13,900 │ ₩99,000  │
│          │         │ /월     │ /월     │ /월      │
└──────────┴─────────┴─────────┴─────────┴──────────┘
```

### 11.5 마케팅 자동화

#### A. 이메일 캠페인

**드립 캠페인 (Drip Campaign):**

1. **가입 후 시리즈:**
   - Day 0: 환영 이메일
   - Day 1: 플랫폼 소개
   - Day 3: 첫 공고 등록 가이드
   - Day 7: 유료 플랜 혜택 소개

2. **무료 체험 시리즈:**
   - Day 0: 체험 시작 안내
   - Day 3: 진행 상황 체크
   - Day 7: 중간 점검
   - Day 11: 유료 전환 유도 (3일 남음)
   - Day 13: 최종 알림 (1일 남음)

3. **이탈 방지 시리즈:**
   - 7일 미접속: "돌아오세요" 이메일
   - 14일 미접속: "이런 기능 써보셨나요?"
   - 30일 미접속: 특별 할인 제공

#### B. 인앱 메시지

**적절한 타이밍에 표시:**
- 공고 등록 5개째: "벌써 5개나! 프로 플랜이 더 효율적일 수 있어요"
- 지원자 30명 돌파: "프로 플랜으로 더 많은 지원자 관리하세요"
- 토너먼트 메뉴 클릭: "프로 플랜에서 사용 가능한 기능입니다"

#### C. 리마케팅

**추적할 이벤트:**
- 가격 페이지 방문
- 특정 플랜 선택
- 결제 페이지 이탈
- 무료 체험 시작
- 체험 종료 전 이탈

**리타게팅 광고:**
- Facebook Pixel
- Google Ads Remarketing
- 카카오 모먼트

### 11.6 데이터 기반 최적화

#### A. A/B 테스트 아이디어

1. **가격 테스트:**
   - 일반 플랜: ₩4,900 vs ₩5,900
   - 프로 플랜: ₩13,900 vs ₩14,900 vs ₩12,900

2. **무료 체험 기간:**
   - 14일 vs 7일 vs 30일
   - 신용카드 필수 vs 선택

3. **CTA 버튼:**
   - "무료로 시작하기" vs "14일 무료 체험" vs "지금 시작"
   - 버튼 색상: 파란색 vs 초록색 vs 빨간색

4. **가격 페이지 레이아웃:**
   - 3단 vs 4단 구성
   - 추천 플랜 위치

#### B. 코호트 분석

**추적할 코호트:**
- 가입 월별
- 추천 경로별 (광고, 검색, 추천인)
- 무료 체험 사용 여부
- 첫 플랜 선택

**측정할 지표:**
- 유료 전환율
- 이탈률
- LTV
- 플랜 업그레이드율

#### C. Funnel 분석

**전환 퍼널:**
```
100% 가격 페이지 방문
  ↓ 60%
60% 플랜 선택
  ↓ 70%
42% 결제 페이지
  ↓ 80%
34% 결제 완료
```

**최적화 지점:**
- 가격 페이지 → 플랜 선택: 60% → 80% 목표
- 플랜 선택 → 결제 페이지: 70% → 85% 목표
- 결제 페이지 → 완료: 80% → 90% 목표

### 11.7 법적 준비사항

#### A. 필수 약관

1. **구독 이용약관**
   - 자동 갱신 안내
   - 해지 정책
   - 환불 정책
   - 요금 변경 통지

2. **결제 약관**
   - 결제 정보 수집 동의
   - 자동 결제 동의
   - 빌링키 저장 동의

3. **개인정보 처리방침**
   - 결제 정보 수집 및 이용
   - 제3자 제공 (PG사)
   - 보유 기간

#### B. 필수 공지사항

**가격 페이지에 명시:**
- "14일 무료 체험 후 자동으로 유료 전환됩니다"
- "언제든지 해지 가능하며, 해지 시 환불 정책에 따릅니다"
- "부가세 포함 가격입니다"

**결제 페이지에 명시:**
- 정기 결제 동의 체크박스
- 약관 동의 체크박스 (필수)
- 결제 수단 저장 동의

---

## 🎯 최종 체크리스트 (최신 업데이트)

### 📊 비즈니스 전략 확인

- [ ] **수익 구조 이해**
  - 구독료 41.3%, 컨설팅 44%, 애드온 14.7%
  - 거래 수수료 모델 제외됨
  - 컨설팅이 핵심 수익원임을 인지

- [ ] **린 운영 계획**
  - 월 ₩7M 비용으로 운영
  - 불필요한 지출 최소화
  - 효율적인 자원 배분

- [ ] **BEP 목표 설정**
  - 7개월 내 342명 확보
  - 월 50명 신규 유치 전략
  - 초기 자본 ₩50M 확보

- [ ] **컨설팅 사업 준비**
  - 패키지 상품 개발
  - 가격 정책 수립 (₩500K, ₩3M)
  - 영업 프로세스 구축
  - 목표: 월 ₩5M 매출

### 개발 전 준비사항

- [ ] PG사 선택 및 계약 (Toss Payments 권장)
- [ ] 상용 개발자 계정 생성 (테스트용)
- [ ] 비즈니스 등록 (사업자번호)
- [ ] 통신판매업 신고
- [ ] 이용약관 및 개인정보처리방침 작성
- [ ] 환불 정책 수립
- [ ] 고객센터 이메일 설정
- [ ] **컨설팅 서비스 약관 작성** ✨

### Phase 1 개발 항목 (0-6개월)

**구독 시스템:**
- [ ] Firestore 컬렉션 설계 및 생성
- [ ] Firebase Security Rules 설정
- [ ] PG사 SDK 연동
- [ ] 구독 관리 UI (플랜 선택, 결제)
- [ ] 사용량 제한 로직
- [ ] 무료 체험 시스템 (프로 1개월)

**추천 시스템 (우선순위 높음!):**
- [ ] 추천 코드 생성 로직
- [ ] 추천 관계 추적
- [ ] 크레딧 자동 지급
- [ ] 추천 대시보드

**기본 관리:**
- [ ] 기본 관리자 페이지
- [ ] 구독 현황 모니터링
- [ ] 사용량 추적

### Phase 2 개발 항목 (6-12개월)

**컨설팅 시스템 (핵심!):**
- [ ] 컨설팅 서비스 신청 페이지
- [ ] 프로젝트 관리 시스템
- [ ] 진행 상황 추적
- [ ] 청구 및 결제
- [ ] 고객 피드백 수집

**구독 고도화:**
- [ ] 정기 결제 Functions 완성
- [ ] 크레딧 시스템 완성
- [ ] 이메일 알림 통합
- [ ] 플랜 업그레이드/다운그레이드

**애드온 시스템:**
- [ ] 애드온 상품 관리
- [ ] 구매 프로세스
- [ ] 사용량 추적

### Phase 3 최적화 항목 (12-24개월)

- [ ] 팀 플랜 런칭
- [ ] A/B 테스팅 도구 연동
- [ ] 분석 대시보드 고도화
- [ ] 쿠폰 시스템
- [ ] 다양한 결제 수단 추가
- [ ] API 개방
- [ ] 파트너 프로그램

### 🚀 우선순위 재정리 (중요!)

**최우선 (Phase 1, 0-3개월):**
1. ⭐⭐⭐ 기본 구독 시스템
2. ⭐⭐⭐ 추천 시스템 (CAC 절감 핵심!)
3. ⭐⭐⭐ 무료 체험 (프로 1개월)
4. ⭐⭐ 사용량 제한

**중요 (Phase 2, 3-6개월):**
1. ⭐⭐⭐ 컨설팅 서비스 시스템 (44% 수익!)
2. ⭐⭐ 정기 결제 자동화
3. ⭐⭐ 크레딧 시스템
4. ⭐ 애드온 판매

**선택 (Phase 3, 6-12개월):**
1. ⭐ 팀 플랜
2. ⭐ 쿠폰 시스템
3. ⭐ 고급 분석

---

## 💡 성공을 위한 핵심 포인트

### ✅ 반드시 해야 할 것

1. **추천 시스템을 초기부터 구현**
   - CAC 80% 절감 (₩400K → ₩7K)
   - 바이럴 성장의 핵심
   - 신규 가입자의 30% 목표

2. **컨설팅 사업에 집중**
   - 전체 수익의 44%
   - 고마진 비즈니스
   - 고객 관계 강화

3. **린 운영 유지**
   - 월 ₩7M 이내
   - 불필요한 지출 억제
   - ROI 중심 의사결정

4. **빠른 실행, 빠른 검증**
   - MVP 3개월 내 런칭
   - 사용자 피드백 즉시 반영
   - 데이터 기반 개선

### ⚠️ 피해야 할 것

1. **거래 수수료 모델 도입 시도**
   - 복잡성 증가
   - 법적 이슈
   - 고객 신뢰 저하

2. **과도한 초기 투자**
   - ₩50M 이상 필요 없음
   - 린 스타트업 방식
   - 점진적 확장

3. **너무 많은 기능 한꺼번에**
   - Phase별 집중
   - 핵심 기능 우선
   - 점진적 개선

4. **컨설팅 사업 소홀**
   - 44% 수익원!
   - 초기부터 준비
   - 표준화된 프로세스

---

**이 가이드를 따라 구현하면 완전한 구독 모델 시스템을 구축할 수 있습니다!** 🚀

## 📈 최종 요약: 수익 모델 완전 정리

### 수익 구조 (12개월 기준)
```
월 수익: ₩10,225,500
├── 구독료 (41.3%): ₩4,225,500
│   ├── 프리: ₩0 (500명)
│   ├── 일반: ₩1,715,000 (350명 × ₩4,900)
│   ├── 프로: ₩2,015,500 (145명 × ₩13,900)
│   └── 팀: ₩495,000 (5명 × ₩99,000)
├── 컨설팅 (44%): ₩4,500,000
│   ├── 운영 최적화: ₩1,500,000 (3건 × ₩500K)
│   └── 맞춤형 개발: ₩3,000,000 (1건 × ₩3M)
└── 애드온 (14.7%): ₩1,500,000
    ├── 추가 공고: ₩265,000
    ├── 추가 지원: ₩350,000
    ├── 분석 리포트: ₩435,000
    └── API 액세스: ₩450,000

연간 수익: ₩122,706,000
```

### 비용 구조 (린 운영)
```
월 비용: ₩7,000,000
├── 개발/운영: ₩1,000,000 (14%)
├── 마케팅: ₩1,000,000 (14%)
├── 인건비: ₩2,000,000 (29%)
├── 인프라: ₩2,000,000 (29%)
└── 기타: ₩1,000,000 (14%)
```

### BEP 달성 계획
```
필요 고객: 342명 (통합 수익 기준)
달성 시점: 7개월
필요 전략:
├── 월 50명 신규 확보
├── 무료 체험 전환율 50%
├── 추천 시스템 적극 활용 (CAC 80% 절감)
└── 컨설팅 사업 조기 시작
```

### 핵심 성공 요소 TOP 3

**1. 추천 시스템 (바이럴 성장) 🔥**
- CAC ₩400K → ₩7K (80% 절감!)
- 가입 크레딧 ₩2,000
- 전환 보너스 ₩5,000
- 신규의 30% 목표

**2. 컨설팅 사업 (고수익) 💼**
- 전체 수익의 44%
- 운영 최적화: ₩500K/건
- 맞춤형 개발: ₩3M/건
- 월 3-4건 목표

**3. 린 운영 (생존력) 💪**
- 월 ₩7M 고정비
- 부트스트랩 가능
- 빠른 BEP (7개월)
- 낮은 리스크

---

**추가 질문이나 특정 부분에 대한 상세 설명이 필요하면 언제든지 물어보세요!**

📧 **문의**: GitHub Issues 또는 프로젝트 Discussions  
📚 **관련 문서**: `subscription_revenue_analysis.md` - 상세 수익 분석 보고서
